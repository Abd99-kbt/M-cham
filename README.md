# 🏦 نظام الرسائل المصرفية الداخلية
## Banking Internal Messaging System

نظام شامل لإدارة المراسلات الداخلية في البنوك والمؤسسات المالية، مطور باستخدام Django مع تركيز على الأمان والكفاءة.

![Python](https://img.shields.io/badge/python-v3.13+-blue.svg)
![Django](https://img.shields.io/badge/django-v5.2.4+-green.svg)
![PostgreSQL](https://img.shields.io/badge/postgresql-supported-blue.svg)
![License](https://img.shields.io/badge/license-MIT-green.svg)

## 📋 المحتويات

- [نظرة عامة](#نظرة-عامة)
- [الميزات الرئيسية](#الميزات-الرئيسية)
- [متطلبات النظام](#متطلبات-النظام)
- [التثبيت والإعداد](#التثبيت-والإعداد)
- [استخدام النظام](#استخدام-النظام)
- [بنية المشروع](#بنية-المشروع)
- [الأمان](#الأمان)
- [API المتاح](#api-المتاح)
- [التقارير](#التقارير)
- [المساهمة](#المساهمة)
- [الدعم](#الدعم)

## 🔍 نظرة عامة

نظام الرسائل المصرفية الداخلية هو حل متكامل مصمم خصيصاً للبنوك والمؤسسات المالية لإدارة المراسلات الداخلية بطريقة آمنة وفعالة. يوفر النظام إدارة شاملة للرسائل مع ميزات أمان متقدمة وسير عمل للموافقات.

### 🎯 الهدف من النظام

- تسهيل التواصل الداخلي بين الأقسام المختلفة
- ضمان أمان المعلومات والبيانات الحساسة
- توفير نظام موافقات مرن ومتدرج
- إدارة المستخدمين والصلاحيات بدقة
- توليد التقارير والإحصائيات التفصيلية

## ✨ الميزات الرئيسية

### 📨 إدارة الرسائل
- ✅ إنشاء وإرسال الرسائل مع مستويات أولوية مختلفة
- ✅ تصنيف الرسائل (ائتمان، خزينة، عمليات، إدارية، إلخ)
- ✅ مستويات سرية متدرجة (عامة، داخلية، سرية، سرية للغاية)
- ✅ إرفاق ملفات متعددة مع التحقق من النوع والحجم
- ✅ مسودات تلقائية ويدوية
- ✅ نظام الرد والتحويل
- ✅ أرشفة الرسائل التلقائية
- ✅ بحث متقدم في المحتوى

### 👥 إدارة المستخدمين والأقسام
- ✅ نظام مستخدمين مخصص مع بيانات البنك
- ✅ إدارة الأقسام والمناصب الوظيفية
- ✅ صلاحيات متدرجة حسب المستوى الوظيفي
- ✅ نظام التفويض المؤقت
- ✅ مجموعات المستخدمين المخصصة

### 🔐 الأمان والحماية
- ✅ تشفير البيانات الحساسة
- ✅ تسجيل جميع العمليات (Audit Logs)
- ✅ مصادقة ثنائية (2FA)
- ✅ قفل الحساب بعد محاولات فاشلة
- ✅ جلسات آمنة مع انتهاء صلاحية
- ✅ توقيع رقمي للرسائل
- ✅ مراقبة الأنشطة المشبوهة

### ⚡ سير العمل والموافقات
- ✅ سير عمل مرن للموافقات
- ✅ موافقات متسلسلة أو متوازية
- ✅ تفويض صلاحيات الموافقة
- ✅ تنبيهات تلقائية للموافقين
- ✅ تتبع حالة الطلبات

### 📊 التقارير والإحصائيات
- ✅ إحصائيات شاملة للرسائل
- ✅ تقارير نشاط المستخدمين
- ✅ تقارير الأقسام والفرق
- ✅ مؤشرات الأداء الرئيسية
- ✅ تقارير الأمان
- ✅ تصدير التقارير (PDF/Excel)

### 🔔 التنبيهات والإشعارات
- ✅ إشعارات فورية للرسائل الجديدة
- ✅ تنبيهات الموافقات المطلوبة
- ✅ إشعارات انتهاء صلاحية الرسائل
- ✅ تحديث العدادات بالوقت الحقيقي

## 🛠 متطلبات النظام

### متطلبات الخادم
- **نظام التشغيل**: Windows/Linux/macOS
- **Python**: 3.11 أو أحدث
- **قاعدة البيانات**: PostgreSQL 12+ (مفضل) أو SQLite للتطوير
- **الذاكرة**: 2GB RAM كحد أدنى، 4GB مفضل
- **التخزين**: 10GB مساحة فارغة كحد أدنى

### متطلبات البرمجة
- Django 5.2.4+
- PostgreSQL driver (psycopg2)
- Pillow (معالجة الصور)
- Celery (للمهام الخلفية)
- Redis (كوسيط للرسائل)

## 🚀 التثبيت والإعداد

### 1. تحضير البيئة

```bash
# استنساخ المشروع
git clone <repository-url>
cd M-cham

# إنشاء البيئة الافتراضية
python -m venv .venv

# تنشيط البيئة الافتراضية
# في Windows:
.venv\Scripts\activate
# في Linux/macOS:
source .venv/bin/activate

# تثبيت المتطلبات
pip install -r requirements.txt
```

### 2. إعداد قاعدة البيانات

```bash
# إنشاء قاعدة بيانات PostgreSQL جديدة
createdb ms

# تحديث إعدادات قاعدة البيانات في myproject/settings.py
DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.postgresql',
        'NAME': 'ms',
        'USER': 'your_username',
        'PASSWORD': 'your_password',
        'HOST': 'localhost',
        'PORT': '5432',
    }
}
```

### 3. تطبيق المايجريشن

```bash
# إنشاء المايجريشن
python manage.py makemigrations

# تطبيق المايجريشن
python manage.py migrate
```

### 4. إعداد البيانات الأولية

```bash
# تشغيل ملف إعداد البيانات الأولية
python setup_initial_data.py
```

### 5. تشغيل الخادم

```bash
# تشغيل خادم التطوير
python manage.py runserver

# الوصول للنظام عبر
http://127.0.0.1:8000/
```

## 📖 استخدام النظام

### بيانات الدخول الافتراضية

| المستخدم | اسم المستخدم | كلمة المرور | الصلاحيات |
|-----------|-------------|------------|-----------|
| المدير العام | admin | bank123456 | إدارة كاملة |
| مدير الائتمان | manager_credit | bank123456 | إدارة الائتمان |
| مدير الخزينة | manager_treasury | bank123456 | إدارة الخزينة |
| موظف ائتمان | officer1 | bank123456 | موظف عادي |
| موظف خزينة | officer2 | bank123456 | موظف عادي |

### الصفحات الرئيسية

- **صفحة الدخول**: `/accounts/login/`
- **لوحة التحكم**: `/dashboard/`
- **صندوق الوارد**: `/messaging/inbox/`
- **إنشاء رسالة**: `/messaging/compose/`
- **الرسائل المرسلة**: `/messaging/sent/`
- **الأرشيف**: `/messaging/archive/`
- **الإدارة**: `/admin/`

## 🏗 بنية المشروع

```
M-cham/
├── 📁 myproject/           # إعدادات Django الرئيسية
│   ├── settings.py         # إعدادات المشروع
│   ├── urls.py            # مسارات URL الرئيسية
│   └── views.py           # العروض الأساسية
├── 📁 accounts/           # إدارة المستخدمين والحسابات
│   ├── models.py          # نماذج المستخدمين والأقسام
│   ├── views.py           # عروض الحسابات
│   └── urls.py            # مسارات الحسابات
├── 📁 messaging/          # نظام الرسائل الأساسي
│   ├── models.py          # نماذج الرسائل
│   ├── views.py           # عروض الرسائل
│   ├── urls.py            # مسارات الرسائل
│   └── reports.py         # نظام التقارير
├── 📁 security/           # الأمان والحماية
│   ├── models.py          # نماذج الأمان
│   └── views.py           # عروض الأمان
├── 📁 workflows/          # سير العمل والموافقات
│   ├── models.py          # نماذج سير العمل
│   └── views.py           # عروض سير العمل
├── 📁 templates/          # قوالب HTML
│   ├── base.html          # القالب الأساسي
│   ├── dashboard.html     # لوحة التحكم
│   ├── 📁 accounts/       # قوالب الحسابات
│   └── 📁 messaging/      # قوالب الرسائل
├── 📁 static/             # الملفات الثابتة
│   ├── 📁 css/           # ملفات الأنماط
│   ├── 📁 js/            # ملفات JavaScript
│   └── 📁 images/        # الصور والأيقونات
└── 📄 requirements.txt    # متطلبات Python
```

## 🔒 الأمان

### ميزات الأمان المطبقة

1. **تشفير البيانات**
   - تشفير كلمات المرور باستخدام Django's PBKDF2
   - تشفير الرسائل الحساسة
   - توقيع رقمي للرسائل المهمة

2. **مصادقة وتخويل**
   - مصادقة ثنائية (2FA) اختيارية
   - جلسات آمنة مع انتهاء صلاحية
   - قفل الحساب بعد محاولات فاشلة

3. **مراقبة ومراجعة**
   - تسجيل جميع العمليات (Audit Logs)
   - مراقبة الأنشطة المشبوهة
   - تتبع عناوين IP وبيانات المتصفح

4. **حماية البيانات**
   - حماية من CSRF و XSS
   - تحديد أنواع الملفات المسموحة
   - فحص حجم الملفات المرفوعة

### إعدادات الأمان

```python
# في settings.py
SESSION_COOKIE_AGE = 1800  # 30 دقيقة
SESSION_EXPIRE_AT_BROWSER_CLOSE = True
SESSION_COOKIE_SECURE = True
SESSION_COOKIE_HTTPONLY = True
CSRF_COOKIE_SECURE = True
SECURE_BROWSER_XSS_FILTER = True
SECURE_CONTENT_TYPE_NOSNIFF = True

# قوة كلمة المرور
AUTH_PASSWORD_VALIDATORS = [
    # الحد الأدنى 12 حرف
    {'NAME': 'django.contrib.auth.password_validation.MinimumLengthValidator',
     'OPTIONS': {'min_length': 12}}
]
```

## 🔌 API المتاح

### نقاط نهاية الرسائل

```http
GET /messaging/api/unread-count/     # عدد الرسائل غير المقروءة
GET /messaging/api/inbox/            # صندوق الوارد
POST /messaging/api/send/            # إرسال رسالة
PUT /messaging/api/read/{id}/        # تعليم كمقروءة
DELETE /messaging/api/delete/{id}/   # حذف رسالة
```

### نقاط نهاية التقارير

```http
GET /reporting/api/stats/            # الإحصائيات العامة
GET /reporting/api/user-activity/    # نشاط المستخدم
GET /reporting/api/department/       # تقرير القسم
GET /reporting/api/security/         # تقرير الأمان
```

## 📊 التقارير

### التقارير المتاحة

1. **الإحصائيات العامة**
   - إجمالي الرسائل
   - الرسائل حسب الحالة
   - الرسائل حسب الأولوية
   - الرسائل حسب التصنيف

2. **تقارير النشاط**
   - نشاط المستخدمين
   - نشاط الأقسام
   - معدل القراءة
   - متوسط وقت الاستجابة

3. **تقارير الأمان**
   - محاولات الدخول الفاشلة
   - الأنشطة المشبوهة
   - سجل العمليات
   - حالة النظام

4. **مؤشرات الأداء**
   - الرسائل اليومية/الأسبوعية/الشهرية
   - الموافقات المعلقة
   - صحة النظام
   - استخدام المساحة التخزينية

### تصدير التقارير

```python
# تصدير إلى Excel
from messaging.reports import export_report_to_excel
export_report_to_excel(report_data, 'report.xlsx')

# تصدير إلى PDF
from messaging.reports import export_report_to_pdf
export_report_to_pdf(report_data, 'report.pdf')
```

## 🔧 التخصيص والتطوير

### إضافة تصنيفات رسائل جديدة

```python
# في messaging/models.py
CATEGORY_CHOICES = [
    ('CUSTOM', 'تصنيف مخصص'),
    # إضافة التصنيفات الجديدة هنا
]
```

### إضافة مستويات صلاحية جديدة

```python
# في accounts/models.py
LEVEL_CHOICES = [
    (8, 'مستوى جديد'),
    # إضافة المستويات الجديدة هنا
]
```

### إضافة سير عمل مخصص

```python
# في workflows/models.py
WORKFLOW_TYPES = [
    ('CUSTOM_APPROVAL', 'موافقة مخصصة'),
    # إضافة أنواع سير العمل الجديدة هنا
]
```

## 🚀 نشر النظام

### إعداد الإنتاج

1. **تحديث الإعدادات**
```python
# في settings.py
DEBUG = False
ALLOWED_HOSTS = ['your-domain.com']
SECURE_SSL_REDIRECT = True
```

2. **إعداد خادم الويب**
```nginx
# مثال على إعداد Nginx
server {
    listen 80;
    server_name your-domain.com;
    
    location /static/ {
        alias /path/to/staticfiles/;
    }
    
    location / {
        proxy_pass http://127.0.0.1:8000;
    }
}
```

3. **إعداد قاعدة البيانات**
```bash
# نسخ احتياطي يومي
pg_dump ms > backup_$(date +%Y%m%d).sql
```

## 📝 المساهمة

نرحب بالمساهمات! يرجى اتباع الخطوات التالية:

1. Fork المشروع
2. إنشاء فرع جديد (`git checkout -b feature/amazing-feature`)
3. Commit التغييرات (`git commit -m 'Add amazing feature'`)
4. Push للفرع (`git push origin feature/amazing-feature`)
5. فتح Pull Request

### إرشادات الكود

- اتباع PEP 8 لـ Python
- إضافة تعليقات باللغة العربية
- كتابة اختبارات للميزات الجديدة
- تحديث التوثيق

## 🐛 الإبلاغ عن المشاكل

إذا واجهت أي مشكلة، يرجى:

1. التحقق من الـ Issues الموجودة
2. إنشاء Issue جديد مع تفاصيل المشكلة
3. تضمين رسائل الخطأ وخطوات إعادة الإنتاج

## 📞 الدعم

- **التوثيق**: راجع هذا الملف والتعليقات في الكود
- **Issues**: استخدم GitHub Issues للمشاكل التقنية
- **البريد الإلكتروني**: [your-email@domain.com]

## 📄 الترخيص

هذا المشروع مرخص تحت رخصة MIT. راجع ملف `LICENSE` للمزيد من التفاصيل.

## 🙏 شكر وتقدير

- فريق Django للإطار الرائع
- مجتمع Python للدعم المستمر
- جميع المساهمين في هذا المشروع

---

**ملاحظة**: هذا النظام مطور خصيصاً للبيئة المصرفية ويتطلب فهماً جيداً لمتطلبات الأمان والامتثال في القطاع المصرفي.

## 📈 خارطة الطريق

### الإصدار القادم (v2.0)
- [ ] دعم الإشعارات عبر البريد الإلكتروني
- [ ] تطبيق موبايل مرافق
- [ ] تكامل مع أنظمة البنك الأساسية
- [ ] ذكاء اصطناعي لتصنيف الرسائل
- [ ] نظام التوقيع الإلكتروني المتقدم

### تحسينات مستقبلية
- [ ] دعم عدة لغات
- [ ] واجهة مستخدم محسنة
- [ ] تقارير تفاعلية
- [ ] نظام التنبيهات المتقدم
- [ ] تشفير من الطرف إلى الطرف

---

📅 **آخر تحديث**: يناير 2025  
🏷️ **الإصدار**: 1.0.0  
👨‍💻 **المطور**: عبدالرحمن كبتول# -_-
# -_-
# -_-
